###########################################
ALL SQL Queries were tried and written here
###########################################


#####################################################################################
class size requirment 
#####################################################################################
SELECT COUNT(*) AS sections
FROM (SELECT *
    FROM seas_department_t INNER JOIN seas_course_t ON deptcode=dept_id
    INNER JOIN seas_section_t ON course_id=courseid)
WHERE noofenrolledstudent BETWEEN 1 AND 10
AND semester = "Summer" AND YEAR = '2021'
------------------------------------------------------------------------------------
UNION ALL
------------------------------------------------------------------------------------
SELECT COUNT(*)
FROM (SELECT *
    FROM seas_department_t INNER JOIN seas_course_t ON deptcode=dept_id
    INNER JOIN seas_section_t ON course_id=courseid)
WHERE noofenrolledstudent BETWEEN 11 AND 20
AND semester = "Summer" AND YEAR = '2021'
------------------------------------------------------------------------------------
UNION ALL
------------------------------------------------------------------------------------
SELECT COUNT(*)
FROM (SELECT *
    FROM seas_department_t INNER JOIN seas_course_t ON deptcode=dept_id
    INNER JOIN seas_section_t ON course_id=courseid)
WHERE noofenrolledstudent BETWEEN 21 AND 30
AND semester = "Summer" AND YEAR = '2021'
------------------------------------------------------------------------------------
UNION ALL
------------------------------------------------------------------------------------
SELECT COUNT(*)
FROM (SELECT *
    FROM seas_department_t INNER JOIN seas_course_t ON deptcode=dept_id
    INNER JOIN seas_section_t ON course_id=courseid)
WHERE noofenrolledstudent BETWEEN 31 AND 35
AND semester = "Summer" AND YEAR = '2021'
------------------------------------------------------------------------------------
UNION ALL
------------------------------------------------------------------------------------
SELECT COUNT(*)
FROM (SELECT *
    FROM seas_department_t INNER JOIN seas_course_t ON deptcode=dept_id
    INNER JOIN seas_section_t ON course_id=courseid)
WHERE noofenrolledstudent BETWEEN 36 AND 40
AND semester = "Summer" AND YEAR = '2021'
------------------------------------------------------------------------------------
UNION ALL
------------------------------------------------------------------------------------
SELECT COUNT(*)
FROM (SELECT *
    FROM seas_department_t INNER JOIN seas_course_t ON deptcode=dept_id
    INNER JOIN seas_section_t ON course_id=courseid)
WHERE noofenrolledstudent BETWEEN 41 AND 50
AND semester = "Summer" AND YEAR = '2021'
------------------------------------------------------------------------------------
UNION ALL
------------------------------------------------------------------------------------
SELECT COUNT(*)
FROM (SELECT *
    FROM seas_department_t INNER JOIN seas_course_t ON deptcode=dept_id
    INNER JOIN seas_section_t ON course_id=courseid)
WHERE noofenrolledstudent BETWEEN 51 AND 55
AND semester = "Summer" AND YEAR = '2021'
------------------------------------------------------------------------------------
UNION ALL
------------------------------------------------------------------------------------
SELECT COUNT(*)
FROM (SELECT *
    FROM seas_department_t INNER JOIN seas_course_t ON deptcode=dept_id
    INNER JOIN seas_section_t ON course_id=courseid)
WHERE noofenrolledstudent BETWEEN 56 AND 65
AND semester = "Summer" AND YEAR = '2021'


#####################################################################################
ClassSizeDistribution
#####################################################################################
SELECT COUNT(*) AS School_SBE
FROM (SELECT *
    FROM seas_department_t INNER JOIN seas_course_t ON deptcode=dept_id
    INNER JOIN seas_section_t ON course_id=courseid)
WHERE noofenrolledstudent BETWEEN 1 AND 10
AND semester = "Summer" AND YEAR = '2021' AND school_id = "SBE"
------------------------------------------------------------------------------------
UNION ALL
------------------------------------------------------------------------------------
SELECT COUNT(*)
FROM (SELECT *
    FROM seas_department_t INNER JOIN seas_course_t ON deptcode=dept_id
    INNER JOIN seas_section_t ON course_id=courseid)
WHERE noofenrolledstudent BETWEEN 11 AND 20
AND semester = "Summer" AND YEAR = '2021' AND school_id = "SBE"
------------------------------------------------------------------------------------
UNION ALL
------------------------------------------------------------------------------------
SELECT COUNT(*)
FROM (SELECT *
    FROM seas_department_t INNER JOIN seas_course_t ON deptcode=dept_id
    INNER JOIN seas_section_t ON course_id=courseid)
WHERE noofenrolledstudent BETWEEN 21 AND 30
AND semester = "Summer" AND YEAR = '2021' AND school_id = "SBE"
------------------------------------------------------------------------------------
UNION ALL
------------------------------------------------------------------------------------
SELECT COUNT(*)
FROM (SELECT *
    FROM seas_department_t INNER JOIN seas_course_t ON deptcode=dept_id
    INNER JOIN seas_section_t ON course_id=courseid)
WHERE noofenrolledstudent BETWEEN 31 AND 35
AND semester = "Summer" AND YEAR = '2021' AND school_id = "SBE"
------------------------------------------------------------------------------------
UNION ALL
------------------------------------------------------------------------------------
SELECT COUNT(*)
FROM (SELECT *
    FROM seas_department_t INNER JOIN seas_course_t ON deptcode=dept_id
    INNER JOIN seas_section_t ON course_id=courseid)
WHERE noofenrolledstudent BETWEEN 36 AND 40
AND semester = "Summer" AND YEAR = '2021' AND school_id = "SBE"
------------------------------------------------------------------------------------
UNION ALL
------------------------------------------------------------------------------------
SELECT COUNT(*)
FROM (SELECT *
    FROM seas_department_t INNER JOIN seas_course_t ON deptcode=dept_id
    INNER JOIN seas_section_t ON course_id=courseid)
WHERE noofenrolledstudent BETWEEN 41 AND 50
AND semester = "Summer" AND YEAR = '2021' AND school_id = "SBE"
------------------------------------------------------------------------------------
UNION ALL
------------------------------------------------------------------------------------
SELECT COUNT(*)
FROM (SELECT *
    FROM seas_department_t INNER JOIN seas_course_t ON deptcode=dept_id
    INNER JOIN seas_section_t ON course_id=courseid)
WHERE noofenrolledstudent BETWEEN 51 AND 55
AND semester = "Summer" AND YEAR = '2021' AND school_id = "SBE"
------------------------------------------------------------------------------------
UNION ALL
------------------------------------------------------------------------------------
SELECT COUNT(*)
FROM (SELECT *
    FROM seas_department_t INNER JOIN seas_course_t ON deptcode=dept_id
    INNER JOIN seas_section_t ON course_id=courseid)
WHERE noofenrolledstudent BETWEEN 56 AND 60
AND semester = "Summer" AND YEAR = '2021' AND school_id = "SBE"
------------------------------------------------------------------------------------
UNION ALL
------------------------------------------------------------------------------------
SELECT COUNT(*)
FROM (SELECT *
    FROM seas_department_t INNER JOIN seas_course_t ON deptcode=dept_id
    INNER JOIN seas_section_t ON course_id=courseid)
WHERE noofenrolledstudent > 60
AND semester = "Summer" AND YEAR = '2021' AND school_id = "SBE"



####################################################################################

####################################################################################


######################################################
*****3. Resource usage summary from a comparison of average enrollment per course
and average capacity per room.*******


#2009-2021 total class_Size and Student enrollment capacity

select semester,year,
sum(capacity) as Sum,
Avg (capacity) as Avg_Room,sum (noofenrolledstudent) as Sum_Of_Enroll,avg(noofenrolledstudent) as Avg_Enroll
from seas_section_t GROUP by semester,year;


#To see specific year 

select semester,year,
sum(capacity),
Avg (capacity),sum (noofenrolledstudent),avg(noofenrolledstudent)
from seas_section_t WHERE year=2009 GROUP by semester,year

# to see specific year and semeter 

select semester,year,
sum(capacity),
Avg (capacity),sum (noofenrolledstudent),avg(noofenrolledstudent)
from seas_section_t WHERE year=2009 and semester='Autumn' GROUP by semester,year; 
# total tabel
SELECT semester,year,
ROUND(sum(capacity),2) as sumcap,
ROUND(avg(capacity),2) as avg_room,
ROUND (sum(noofenrolledstudent),2) as Sum_of_enroll,
ROUND(avg(noofenrolledstudent),2) as avg_enroll,
ROUND((avg(capacity)-avg(noofenrolledstudent)),2) as Differ,
ROUND(((avg(capacity)-avg(noofenrolledstudent))/avg(capacity)*100),2)as [Unused %]
from seas_section_t GROUP by semester,year;


******reVNEW********
 select dept_id,
ROUND (sum(credithour),2) as total_creadi
from seas_course_t
group by dept_id




